# Copilot Instructions for Valentine's Card App

## Overview

This is an interactive Valentine's Day card web application built with React, TypeScript, and Vite. The app features a playful interface where users can accept a Valentine's Day proposal, with a "No" button that dodges the cursor. Upon acceptance, it displays a personalized message generated by Google's Gemini AI and triggers a confetti animation.

**Tech Stack:**
- **Framework:** React 19.2.4
- **Language:** TypeScript 5.8.2
- **Build Tool:** Vite 6.2.0
- **UI Libraries:** Lucide-react (icons), canvas-confetti
- **AI Integration:** @google/genai (Gemini API)
- **Runtime:** Node.js

## Build and Development

### Prerequisites
- Node.js (latest stable version recommended)
- A Gemini API key (set in `.env.local` as `GEMINI_API_KEY`)

### Commands

**Always run `npm install` first** after cloning or when dependencies change.

#### Development
```bash
npm run dev
```
- Starts Vite dev server on `http://0.0.0.0:3000`
- Supports hot module replacement (HMR)
- Typical startup time: ~2 seconds

#### Build
```bash
npm run build
```
- Compiles TypeScript and bundles the app for production
- Output directory: `dist/`
- Build time: ~2-5 seconds
- Build output size: ~480KB (121KB gzipped)

#### Preview
```bash
npm run preview
```
- Serves the production build locally for testing

### Environment Setup
- Create `.env.local` file with `GEMINI_API_KEY=your_api_key_here`
- The Vite config exposes this as `process.env.API_KEY` and `process.env.GEMINI_API_KEY` to the app

## Project Structure

```
.
├── App.tsx                 # Main application component
├── index.tsx              # App entry point
├── index.html             # HTML template (includes ESM import maps for CDN)
├── services/
│   └── geminiService.ts   # Gemini AI API integration
├── types.ts               # TypeScript type definitions
├── package.json           # Dependencies and scripts
├── tsconfig.json          # TypeScript configuration
├── vite.config.ts         # Vite build configuration
└── README.md              # Setup instructions

No .github/ directory exists yet (no CI/CD workflows)
```

### Key Files

**App.tsx**
- Contains three main components:
  - `FloatingHearts`: Animated background hearts
  - `ValentineCard`: Initial proposal view with dodging "No" button
  - `SuccessView`: Acceptance view with confetti and AI-generated message
- Uses React hooks: `useState`, `useEffect`, `useCallback`, `useRef`

**services/geminiService.ts**
- Single function: `generateSweetNote()` 
- Generates cute Valentine's messages using Gemini AI
- Falls back to default message if API fails

**vite.config.ts**
- Configures server to run on port 3000
- Defines environment variable mappings
- Sets up path aliases (@/ -> root)

**index.html**
- Uses Tailwind CSS via CDN
- Includes custom fonts (Pacifico, Poppins)
- Uses ESM import maps to load React/ReactDOM from esm.sh CDN
- **Critical:** Contains `<script type="module" src="/index.tsx"></script>` for bundling

## Conventions and Best Practices

### Code Style
- Use functional React components with hooks
- Prefer `const` for component declarations
- Use TypeScript with strict typing
- Component props should use `React.FC<Props>` pattern
- File naming: PascalCase for components, camelCase for utilities

### TypeScript
- Target: ES2022
- JSX: react-jsx (automatic runtime)
- Module resolution: bundler
- `noEmit: true` (Vite handles compilation)

### Dependencies
- Production dependencies are minimal and well-maintained
- Use `lucide-react` for icons (already included)
- Confetti effects use `canvas-confetti` library

### When Making Changes
1. **Always** test with `npm run build` before finalizing
2. Ensure the app still runs with `npm run dev`
3. Check that environment variables are properly accessed via `process.env.API_KEY`
4. Verify that changes don't break the mobile-responsive layout (Tailwind classes)

## Common Pitfalls

1. **API Key Issues**: The Gemini API key must be in `.env.local` and accessed as `process.env.API_KEY` or `process.env.GEMINI_API_KEY`
2. **Import Paths**: Use ESM imports. The build uses Vite's bundler module resolution
3. **Type Safety**: Always maintain TypeScript types. Don't use `any` unless absolutely necessary
4. **Build Artifacts**: The `dist/` directory is gitignored. Never commit build output
5. **Node Modules**: Always in .gitignore. Run `npm install` to restore

## Validation Steps

Before considering a change complete:
1. Run `npm run build` - should complete without errors
2. Test the dev server: `npm run dev`
3. Verify API calls work (if modified services)
4. Check console for errors
5. Ensure responsive design still works

## Additional Notes

- No testing framework is currently set up (no test command in package.json)
- No linting configuration present (no ESLint/Prettier configs)
- No CI/CD pipelines configured
- The app is designed for deployment as a static site (SPA)
- The "No" button uses transform animations and requires careful handling of position calculations

## Trust These Instructions

These instructions have been validated by building the project successfully. If something doesn't work as described, first verify your environment setup (Node.js version, dependencies installed) before exploring alternatives. The documented commands are known to work correctly as of the time of writing.
